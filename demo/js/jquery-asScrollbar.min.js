/*! jQuery plugin - v0.1.1 - 2014-07-04
* https://github.com/amazingSurge/jquery-asScrollbar
* Copyright (c) 2014 amazingSurge; Licensed GPL */
!function(a,b,c){"use strict";var d="asScrollbar",e=a[d]=function(b,c){var d,f=this.$container=a(c);b=this.options=a.extend({},e.defaults,b||{}),"vertical"===this.options.direction?d=this.oriAttr={x:"Y",pos:"top",crossPos:"left",size:"height",crossSize:"width",client:"clientHeight",crossClient:"clientWidth",offset:"offsetHeight",crossOffset:"offsetWidth",offsetPos:"offsetTop",scroll:"scrollTop",scrollSize:"scrollHeight",overflow:"overflow-y",pageOffset:"pageYOffset",mouseAttr:"pageY"}:"horizontal"===this.options.direction&&(d=this.oriAttr={x:"X",pos:"left",crossPos:"top",size:"width",crossSize:"height",client:"clientWidth",crossClient:"clientHeight",offset:"offsetWidth",crossOffset:"offsetHeight",offsetPos:"offsetLeft",scroll:"scrollLeft",scrollSize:"scrollWidth",overflow:"overflow-x",pageOffset:"pageXOffset",mouseAttr:"pageX"});var g=this.$content=f.find("."+b.contentClass);0===g.length&&(f.wrapInner('<div class="'+b.contentClass+'"/>'),g=this.$content=f.find("."+b.contentClass));var h=this.$wrapper=f.find("."+b.wrapperClass);0===h.length&&(g.wrap('<div class="'+b.wrapperClass+'"/>'),h=this.$wrapper=g.parents("."+b.wrapperClass)),f.css({overflow:"hidden",position:"relative"});var i=h[0];h.css(d.overflow,"scroll").css(d.crossSize,i.parentNode[d.crossClient]+i[d.crossOffset]-i[d.crossClient]+"px"),g.css("overflow","hidden").css(d.crossSize,"auto"),this.origPosition=0,this.origHanlePosition=0,this.initLayout(),this.initEvent()};e.defaults={contentClass:"content",wrapperClass:"wrapper",barClass:"scrollbar",barTmpl:'<div class="scrollbar"><div class="handle"></div></div>',handleClass:"handle",direction:"vertical",namespace:"asScrollable",responsive:!1},e.prototype={constructor:e,initLayout:function(){var a=this.$wrapper,b=this.$container;"horizontal"===this.options.direction?b.css("height",b.height()):a.css("height",b.height()),this.initBarLayout(),b.trigger(this.eventName("initLayout"))},initBarLayout:function(){var b=this.oriAttr,c=this.options,d=this.$wrapper,e=this.$wrapper[0],f=this.$content[0];"undefined"==typeof this.$bar&&(this.$bar=this.$container.find("."+c.barClass),0===this.$bar.length&&(this.$bar=a(c.barTmpl),this.$bar.appendTo(d)),this.$bar.addClass(c.direction).attr("draggable",!1));var g=this.$handle=this.$bar.find("."+c.handleClass),h=this.$bar[0],i=this.$handle[0],j=f[b.offset],k=e[b.client];if(j-k>0)if(g.css(b.size,h[b.client]*k/j),"undefined"==typeof this.bLength){this.hLength=i[b.client],this.bLength=h[b.client]-this.hLength;var l=this.getPercentOffset();this.hPosition=l*this.bLength,0!==this.hPosition&&this.handleMove(this.hPosition,!1)}else{var m=this.bLength;this.hLength=i[b.client];var n=this.bLength=h[b.client]-this.hLength,o=this.getHanldeOffset();0!==o&&(o=o*n/m,o>n&&(o=n),this.$handle.css(b.pos,o))}else this.$bar.hide()},initEvent:function(){var d=this,e=this.$wrapper,f=this.$container,g=this.$bar;e.on("scroll",function(){var b=d.getPercentOffset();a(this).trigger(d.eventName("change"),[b,"content"])}),g.on("mousedown",function(c){var e=d.oriAttr,f=d.bLength,g=d.hLength,h=d.$handle;if(d.hPosition=d.getHanldeOffset(),a(c.target).is(h))d.dragStart=c[e.mouseAttr],d.isDrag=!0,h.addClass("is-drag"),d.$bar.trigger(d.eventName("dragstart")),a(b).on(d.eventName("selectstart"),function(){return!1}),d.$container.css({"-moz-user-focus":"ignore","-moz-user-input":"disabled","-moz-user-select":"none"}),a(b).on(d.eventName("mousemove"),function(a){if(d.isDrag){var b=d.oriAttr,c=d.bLength,e=a[b.mouseAttr],f=d.dragStart,g=d.hPosition+e-f;0>g?g=0:g>c&&(g=c),d.handleMove(g,!1,!0)}});else{var i=c[e.mouseAttr]-d.$bar.offset()[e.pos]-g/2;0>i?i=0:i>f&&(i=f),d.handleMove(i,!1,!0)}a(b).one(d.eventName("mouseup blur"),function(){d.$handle.removeClass("is-drag"),d.$bar.trigger("dragend."+d.options.namespace),d.isDrag=!1,a(b).off(d.eventName("selectstart mousemove")),d.$container.css({"-moz-user-focus":"inherit","-moz-user-input":"inherit","-moz-user-select":"inherit"})})}),f.on(this.eventName("change"),function(a,b,c){"bar"===c?d.move(b,!0):"content"===c&&d.handleMove(b,!0),f.addClass("is-scrolled"),0===b?(f.removeClass("is-scrolled"),d.$container.trigger(d.eventName("hitstart"))):1===b&&d.$container.trigger(d.eventName("hitend"))}),this.options.responsive&&a(c).resize(function(){d.initLayout()})},getHanldeOffset:function(){return parseInt(this.$handle.css(this.oriAttr.pos).replace("px",""),10)},getContentOffset:function(){var a=this.oriAttr,b=this.$wrapper[0];return b[a.pageOffset]||b[a.scroll]},getPercentOffset:function(){var a=this.oriAttr,b=this.$wrapper[0],c=this.$content[0];return this.getContentOffset()/(c[a.client]-b[a.offset])},handleMove:function(a,b,c){var d,e=this.$handle,f={},g=this.bLength,h=this.oriAttr,i=this.$bar;b?(a*=g,d=a):d=a/g,f[h.pos]=a,e.css(f),c&&i.trigger(this.eventName("change"),[d,"bar"])},eventName:function(a){if("string"!=typeof a||""===a)return!1;a=a.split(" ");for(var b=this.options.namespace,c=a.length,d=0;c>d;d++)a[d]=a[d]+"."+b;return a.join(" ")},move:function(a,b){var c=this.oriAttr,d=this.$wrapper[0],e=this.$content[0];if(b){if(a>1||0>a)return!1;a=-a*(d[c.offset]-e[c.client])}d[c.scroll]=a},destory:function(){this.$bar.remove(),this.$container.html(this.$content.html()),this.$container.removeData("asScrollbar")}},a.fn[d]=function(b){if("string"==typeof b){var c=Array.prototype.slice.call(arguments,1);this.each(function(){var e=a(this).data(d);return e&&a.isFunction(e[b])&&"_"!==b.charAt(0)?void e[b].apply(e,c):!1})}else this.each(function(){a(this).data(d)||a(this).data(d,new e(b,this))});return this}}(jQuery,document,window);